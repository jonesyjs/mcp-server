services:
  mcp-server:
    image: ghcr.io/jonesyjs/mcp-server:latest
    container_name: mcp-server
    ports:
      - "8223:8223"
    volumes:
      - ~/skills:/skills:ro
    environment:
      - NODE_ENV=production
      - AUTH_PASSWORD=${AUTH_PASSWORD}
      - CLIENT_SECRET=${CLIENT_SECRET}
      - NTFY_TOPIC=${NTFY_TOPIC}
    restart: unless-stopped

  cloudflared:
    image: cloudflare/cloudflared:latest
    container_name: cloudflared
    command: tunnel run
    environment:
      - TUNNEL_TOKEN=${CLOUDFLARE_TUNNEL_TOKEN}
    depends_on:
      - mcp-server
    restart: unless-stopped

  watchtower:
    image: containrrr/watchtower
    container_name: watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - WATCHTOWER_CLEANUP=true
      - WATCHTOWER_POLL_INTERVAL=30
    restart: unless-stopped

